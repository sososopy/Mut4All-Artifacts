Issue Title:
ICE in `rustc::hir::map::definitions::Definitions::local_def_id` when a recursive macro uses log_syntax · Issue #36943 · rust-lang/rust · GitHub

Rust Code:
#![feature(log_syntax)]

#[macro_export]
macro_rules! ice {
    // Entry point
    ( ice; ) => {
        // Just add braces
        ice! {{ ice; }}
    };
    ( { ice; } ) => {
        log_syntax!("Move ice outside the braces");

        ice! { { } ice; }
    };
    ( { } ice; ) => {
        log_syntax!("Done");

        pub trait ThisWillIce {
            log_syntax!("Oh no!");
        }
    }
}

ice! {
    ice;
}

fn main() {
}

Bug Labels:
A-macros, I-ICE
