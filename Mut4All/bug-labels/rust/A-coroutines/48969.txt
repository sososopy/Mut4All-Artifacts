Issue Title:
`assertion failed: current_depth > 1` when using generators and conservative impl trait with an impl lifetime · Issue #48969 · rust-lang/rust · GitHub

Rust Code:
#![feature(generators)]

extern crate futures;

use futures::{future, Future, FutureExt};

fn main() {
    || {
        let _future = Struct::method();
        yield ();
    };
}

struct Struct;

impl<'a> Struct {
    fn method() -> impl Future<Item = (), Error = ()> + 'a {
        future::loop_fn(future::ok(()), |builder| {
            builder.map(|_| unimplemented!())
        })
    }
}

Bug Labels:
A-coroutines, C-bug, I-ICE
