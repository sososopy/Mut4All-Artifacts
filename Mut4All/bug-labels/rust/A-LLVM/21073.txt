Issue Title:
Assertion failed while type-casting · Issue #21073 · rust-lang/rust · GitHub

Rust Code:
struct Foo {
    a: u64,
    b: u32,
    c: u8
}

macro_rules! offset_of {
  ($t:ty, $field:ident) => {
    unsafe {
      (&(*(0 as *const $t)).$field) as *const _ as *const _
    }
  }
}

const OFFSET_OF_C: *const () = offset_of!(Foo, c);

fn main() {
  println!("offset of c: {}" , OFFSET_OF_C as usize);
}

Bug Labels:
A-LLVM, I-ICE
