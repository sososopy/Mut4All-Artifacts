Issue Title:
Associated types Order can cause ICE · Issue #18611 · rust-lang/rust · GitHub

Rust Code:
#![feature(associated_types)]

struct SimulationInfo;

impl SimulationInfo {
    fn add_state<T: HasState>(&mut self, op: || -> <T as HasState>::State)
        -> Option<&mut <T as HasState>::State> {
        None
    }
}

trait HasState {
    type State;
}

Bug Labels:
A-associated-items, E-needs-test, I-ICE
