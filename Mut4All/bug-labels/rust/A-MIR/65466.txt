Issue Title:
ICE resolving non-existent PartialEq::Eq from match of const · Issue #65466 · rust-lang/rust · GitHub

Rust Code:
#![deny(indirect_structural_match)]

#[derive(PartialEq, Eq)]
enum O<T> {
    Some(*const T), // Can also use PhantomData<T>
    None,
}

struct B;

const C: &[O<B>] = &[O::None];

pub fn foo() {
    let x = O::None;
    match &[x][..] {
        C => (),
        _ => (),
    }
}

Bug Labels:
A-MIR, C-bug, I-ICE, P-high, T-compiler, glacier
